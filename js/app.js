"use strict";!function(e,t){"function"==typeof define&&define.amd?define(["jquery","tinycolor2","angular","angular-cookies","ngstorage","@uirouter/angularjs","angular-animate","angular-aria","angular-combine","angular-clipboard","angular-material","angular-translate","angular-translate-loader-static-files","angular-translate-storage-cookie","angular-translate-storage-local"],t):"object"==typeof module&&module.exports?module.exports=t(require("jquery"),require("tinycolor2"),require("angular"),require("angular-cookies"),require("ngstorage"),require("@uirouter/angularjs"),require("angular-animate"),require("angular-aria"),require("angular-combine"),require("angular-clipboard"),require("angular-material"),require("angular-translate"),require("angular-translate-loader-static-files"),require("angular-translate-storage-cookie"),require("angular-translate-storage-local")):t(e.jQuery,e.tinycolor,e.angular)}(this,function(e,t,n){var a=["ngAnimate","ngAria","ngMaterial","ngMessages","ngStorage","pascalprecht.translate","angular-clipboard","ui.router","app.info","app.translate","app.stateData"],r=["$stateProvider","$urlRouterProvider","$mdIconProvider","EXPORT_FORMATS"],o=["$rootScope","themeService"];"undefined"!=typeof jasmine||(a.push("angularCombine"),r.push("angularCombineConfigProvider")),r.push(function(e,t,n,a,r){void 0!==r&&r.addConf(/./,"tmpl/app.html"),n.defaultFontSet("material-icons"),t.otherwise("/"),e.state("main",{url:"/",templateUrl:"views/pages/main.html",data:{pageTitle:"main.title",pageLead:"main.brief"}}).state("demo",{url:"/demo",templateUrl:"views/pages/demo/layout.html",data:null}),a.forEach(function(t){e.state("demo."+t,{url:"/"+t,template:"<demo flex></demo>",data:{pageTitle:"demo.".concat(t,".title")}})})}),o.push(function(e,t){e.themeService=t,e.settings={instantUpdate:!0}});var i=n.module("app",a).config(r).run(o);i.service("paletteService",["$rootScope","$mdTheming","mdThemingProvider","COLOR_VALUES",function(e,a,r,o){this.CONTRAST_DARK=[0,0,0,.87],this.CONTRAST_LIGHT=[255,255,255,.87],this.CONTRAST_DARK.css="rgba(0,0,0,0.87)",this.CONTRAST_LIGHT.css="rgba(255,255,255,0.87)",this.custom={},this.palettes=Object.keys(a.PALETTES),this.validateName=function(e){return/[a-z][-a-z0-9_]*/.test(e)?a.PALETTES[e]?2:0:1},this.tinycolor=function(e){return"string"==typeof e?t(e):e},this.newName=function(){var e,t=0;do{e="palette"+t++}while(this.custom[e]);return e},this.add=function(t,n,o){t||(t=this.newName()),n||(n=this.palette("#ff00ff")),n.name=t,r.definePalette(t,n),this.custom[t]=a.PALETTES[t],this.palettes.push(t),o||e.$broadcast("palette-add",t)},this.remove=function(t,n){this.custom[t]&&(this.palettes.splice(this.palettes.indexOf(t),1),delete this.custom[t],delete a.PALETTES[t],n||e.$broadcast("palette-remove",t))},this.rename=function(t,n){var a=this.custom[t];this.remove(t,!0),this.add(n,a,!0),e.$broadcast("palette-rename",t,n)},this.update=function(t){this.custom[t]&&(r.definePalette(t,this.custom[t]),e.$broadcast("palette-update",t))},this.reset=function(){var t=0;for(var n in this.custom)delete this.custom[n],delete a.PALETTES[n],e.$broadcast("palette-remove",n),++t;this.palettes.length-=t},this.contrast=function(e){return(e=this.tinycolor(e)).isLight()?this.CONTRAST_DARK:this.CONTRAST_LIGHT},this.color=function(e){var t=(e=this.tinycolor(e)).toRgb();return{hex:e.toHexString(),value:[t.r,t.g,t.b],contrast:this.contrast(e)}},this._fromRgb=function(e){return t("rgb(".concat(e.join(","),")"))},this._dark=function(e){var t=[0,0,0];return e=e.toRgb(),t.forEach(function(n,a){n="rgb"[a],t[a]=Math.floor(e[n]*e[n]/255)}),this._fromRgb(t)},this._palette=function(e){e=t(e);var n=t("#fff"),a=this._dark(e),r=t.mix(a,e.tetrad()[3],15),o=r.clone().saturate(100);r.saturate(80);var i=function(a){return t.mix(e,n,a)},l=function(n){return t.mix(e,a,n)};return[i(75),i(50),i(45),i(30),i(15),e,l(15),l(30),l(50),l(75),r.clone().lighten(60),r.lighten(50),o.clone().lighten(40),o.lighten(30)]},this.palette=function(e){var t=this,n={base:e,baseContrast:this.contrast(e)};return this._palette(e).forEach(function(e,a){n[o[a]]=t.color(e)}),n},this.setColor=function(e,t,a){var r=this.custom[e];r&&("base"===t?n.extend(r,this.palette(a)):r[t]=this.color(a),this.update(e))}}]),i.service("themeExportService",["themeService","paletteService","THEME_PALETTES","COLOR_VALUES",function(e,t,n,a){var r=this;r.materialize=function(){return"test"},r._ng1Palette=function(e,t){var n=['\t$mdThemingProvider.definePalette("'.concat(e,'", {')];return a.forEach(function(e,r){n.push('\t\t"'.concat(e,'": ',JSON.stringify(t[e]),r+1<a.length?",":""))}),n.push("\t});"),n.push(""),n.join("\n")},r.ng1=function(a,o){a=a||e.theme,o=o||t.custom;var i={},l=['app.config(["$mdThemingProvider", function($mdThemingProvider) {'];return n.forEach(function(e){var t=a[e];o[t]&&!i[t]&&(i[t]=!0,l.push(r._ng1Palette(t,o[t])))}),l.push('\t$mdThemingProvider.theme("default")'),n.forEach(function(e){var t=a[e];l.push("\t\t.".concat(e,'Palette("',t,'")'))}),a.dark?l.push("\t\t.dark();"):l[l.length-1]+=";",l.push("}]);"),l.push(""),l.join("\n")}}]),i.constant("THEME_PALETTES",["background","primary","accent","warn"]).constant("COLOR_VALUES",["50","100","200","300","400","500","600","700","800","900","A100","A200","A400","A700"]).constant("EXPORT_FORMATS",["ng1"]),i.config(["$provide","$mdThemingProvider",function(e,t){e.value("mdThemingProvider",t)}]),i.service("themeService",["$rootScope","mdThemingProvider","$mdTheming","THEME_PALETTES",function(t,a,r,o){var i=this,l=0,c={background:"grey",primary:"indigo",accent:"pink",warn:"deep-orange",dark:!1};this.name="default",this.theme=n.copy(c),this.rebuild=function(){if(l){var t=e("style[md-theme-style]");t.slice(0,t.length-16).remove(),delete r.THEMES["theme"+l]}this.name="theme"+ ++l,a.theme(this.name).primaryPalette(this.theme.primary).backgroundPalette(this.theme.background).accentPalette(this.theme.accent).warnPalette(this.theme.warn).dark(this.theme.dark),r.generateTheme(this.name)},this.reset=function(){n.extend(this.theme,c)},this.replacePalette=function(e,t){o.forEach(function(n){i.theme[n]===e&&(i.theme[n]=t)})},t.$watchCollection(function(){return i.theme},function(){i.rebuild()}),t.$on("palette-remove",function(e,t){i.replacePalette(t,"grey")}),t.$on("palette-rename",function(e,t,n){i.replacePalette(t,n)}),t.$on("palette-update",function(e,t){o.some(function(e){return i.theme[e]===t})&&i.rebuild()})}]),i.animation(".fold-animation",["$animateCss",function(e){function t(e,t,n,a){var r="max-"+n;e[r]=a[n]()+"px",t[r]="0px"}function n(e,n){var i=n?"to":"from",l=n?"from":"to",c={},s={overflow:"hidden"},u=+(e.width()/e.parent().width()>.5);t(c,s,o[u],e),e.siblings(".fold-animation").length||t(c,s,o[1-u],e);var m={easing:r,duration:a};return m[i]=s,m[l]=c,m}var a=.25,r="ease-out",o=["width","height"];return{enter:function(t,a){return e(t,n(t)).start().done(function(){t.css({"max-width":"","max-height":"",overflow:""}),a()})},leave:function(t){return e(t,n(t,!0))}}}]),n.module("app.info",[]).constant("version","1.0").constant("languages",["en","ru"]).constant("defaultLanguage","en").directive("appVersion",["version",function(e){return function(t,n){n.text(e)}}]).directive("currentYear",function(){return{link:function(e,t){t.html("&copy; "+(new Date).getFullYear())}}}),i.directive("replace",["$compile","$templateRequest",function(e,t){return{restrict:"E",link:function(n,a,r){var o=r.src;t(o).then(function(t){a.html(t),t=a.children(),a.replaceWith(t),e(t)(n)})}}}]),n.module("app.stateData",["ui.router"]).run(["$transitions","$rootScope",function(e,t){e.onSuccess({},function(e){var n=e.to();t.stateData=n.data,t.stateName=n.name})}]);var l=n.module("app.translate",["app.info","pascalprecht.translate","ngCookies","ngStorage"]).config(["$translateProvider","defaultLanguage",function(e,t){e.useStaticFilesLoader({prefix:"languages/",suffix:".json"}).useSanitizeValueStrategy("escape").preferredLanguage(t).fallbackLanguage(t).useLocalStorage()}]);i.directive("paletteSelect",function(){return{restrict:"E",replace:!0,scope:{name:"=",ngModel:"=",options:"="},templateUrl:"views/app/palette-select.html"}}),i.directive("inputColor",["paletteService",function(e){return{restrict:"E",replace:!1,transclude:!0,require:"ngModel",scope:{ngModel:"=",instantUpdate:"="},templateUrl:"views/app/input-color.html",link:function(n,a,r,o){var i=a.find("input"),l=function(){n.ngModel=n.color,o.$setViewValue(n.color)};i.on("change",function(){n.$apply(l)}),o.$render=function(){n.color=t(o.$viewValue).toHexString(),i.val(n.color)},n.input=function(){i.click()},n.$watch("color",function(a){n.contrast=e.contrast(t(a)).css,n.instantUpdate&&l()})}}}]),i.directive("paletteEditor",[function(){return{restrict:"E",replace:!0,transclude:!0,scope:{name:"=",instantUpdate:"="},controller:"PaletteEditorController",controllerAs:"ctrl",templateUrl:"views/app/palette-editor.html"}}]),i.controller("PaletteEditorController",["$scope","$mdDialog","themeService","paletteService","COLOR_VALUES",function(e,t,n,a,r){var o=this;this.COLOR_VALUES=r,this.update=function(t){var n=this.palette[t].hex;a.setColor(e.name,t,n)},this.reset=function(){a.setColor(e.name,"base",this.palette.base)},this.remove=function(){a.remove(e.name)},this.rename=function(){t.show(t.renamePalette({locals:{name:e.name}}).theme(n.name)).then(function(t){a.rename(e.name,t),e.name=t},function(){})},e.$watch("name",function(e){o.palette=a.custom[e]})}]),l.directive("languageSelect",function(){return{restrict:"E",replace:!0,templateUrl:"views/common/language-select.html",controller:"LanguageController",controllerAs:"language"}}),l.directive("languageMenu",function(){return{restrict:"E",replace:!0,templateUrl:"views/common/language-menu.html",controller:"LanguageController",controllerAs:"language"}}),l.controller("LanguageController",["$translate","$scope","languages",function(e,t,n){t.vm={languages:n,language:null},t.$watch(function(){return e.use()},function(e){t.vm.language=e}),t.$watch("vm.language",function(t){e.use(t)})}]),i.controller("ExportDataDialogController",["$mdDialog","$mdToast","$translate","themeService","themeExportService","EXPORT_FORMATS",function(e,t,n,a,r,o){function i(e){t.show(t.simple().hideDelay(1500).textContent(e))}var l=this;l.EXPORT_FORMATS=o,"string"==typeof l.selected&&(l.selected=o.indexOf(l.selected)),l.selected=0|l.selected,o.forEach(function(e){l[e]=r[e]()}),l.close=function(){e.hide()},l.copySuccess=function(){i(n.instant("action.copy.success").concat(": ",o[l.selected]))},l.copyError=function(e){i(n.instant("action.copy.error").concat(": ",o[l.selected],": ",e.toString()))}}]),i.config(["$mdDialogProvider",function(e){e.addPreset("exportData",{methods:["theme"],options:function(){return{templateUrl:"views/dialogs/export-data.html",controller:"ExportDataDialogController",controllerAs:"dialog",bindToController:!0,clickOutsideToClose:!0,escapeToClose:!0}}})}]),i.controller("RenamePaletteDialogController",["$mdDialog","paletteService",function(e,t){this.result=this.name,this.cancel=function(){e.cancel()},this.ok=function(){e.hide(this.result)},this.valid=function(){return t.validateName(this.result)}}]),i.config(["$mdDialogProvider",function(e){e.addPreset("renamePalette",{methods:["theme"],options:function(){return{templateUrl:"views/dialogs/rename-palette.html",controller:"RenamePaletteDialogController",controllerAs:"dialog",bindToController:!0,clickOutsideToClose:!0,escapeToClose:!0}}})}]),i.directive("navBar",function(){return{restrict:"E",replace:!0,templateUrl:"views/nav/nav.html",controller:"NavController",controllerAs:"navbar"}}),i.controller("NavController",[function(){}]),i.directive("sideNav",["$transitions","$timeout",function(e,t){return{restrict:"E",replace:!0,templateUrl:"views/nav/sidenav.html",controller:"SideNavController",controllerAs:"sidenav",link:function(n,a){e.onBefore({},n.sidenav.close),e.onSuccess({},function(){t(function(){a.find("md-list-item > .md-button").removeClass("md-focused"),a.find("md-list-item.active > .md-button").addClass("md-focused")})})}}}]),i.controller("SideNavController",["$scope","$mdSidenav","$mdDialog","$translate","themeService","paletteService","themeExportService","EXPORT_FORMATS",function(e,t,n,a,r,o,i,l){var c=function(){return t("sidenav")};this.open=function(){c().open()},this.toggle=function(){c().toggle()},this.close=function(){c().close()},this.EXPORT_FORMATS=l,this.exportData=function(e){this.close(),n.show(n.exportData({locals:{selected:e}}).theme(r.name))},this.reset=function(){var e=n.confirm().title(a.instant("action.reset.confirm.title")).textContent(a.instant("action.reset.confirm.text")).clickOutsideToClose(!0).escapeToClose(!0).theme(r.name).ok(a.instant("action.ok")).cancel(a.instant("action.cancel"));n.show(e).then(function(){r.reset(),o.reset()},function(){})}}]),i.controller("MainController",["$mdDialog","themeService","paletteService","THEME_PALETTES",function(e,t,n,a){this.THEME_PALETTES=a,this.theme=t.theme,this.palettes=n.palettes,this.customPalettes=n.custom,this.addPalette=function(){n.add()}}]),i.controller("DemoController",["$rootScope","$scope","themeExportService",function(e,t,n){var a=this,r=e.$watch("stateName",function(){var t=e.stateName.substr(e.stateName.lastIndexOf(".")+1);console.log("state change",e.stateName,t),a.format=t,a.args="?theme="+encodeURIComponent(n[t]()),a.loading=!0,a.show=!1});t.$on("$destroy",function(){console.log("destroy"),r()})}]),i.directive("demo",["$interval","$timeout",function(e,t){return{replace:!0,template:"<iframe></iframe>",link:function(n,a){var r={ng1:function(e){return e.hasAttribute("ng-cloak")},materialize:function(e){return e.classList.contains("hide")},default:function(){return!1}};t(function(){var t=n.demo,o="demo/".concat(t.format,"/index.html",t.args),i=r[t.format];i||(i=r.default),a.attr("src",o),a.on("load",function(){n.$apply(function(){t.show=!0});var r=e(function(){var n=a.contents()[0].body;(t.loading=i(n))||(e.cancel(r),r=null)},250);n.$on("$destroy",function(){null!==r&&e.cancel(r)})})})}}}])});
